@using PatientManagement.App.Domain.Dtos

@page "/cares"

<MudText Typo="Typo.h4" GutterBottom="true">Atendimentos</MudText>

<MudTable Items="@_cares" Dense="@dense" Hover="@hover" Bordered="@bordered" Striped="@striped" Filter="new Func<CareDto,bool>(FilterFunc1)" @bind-SelectedItem="selectedCare">
    <ToolBarContent>
        <MudGrid GutterSize="3" Class="align-center">
            <MudItem xs="7" md="9">
                <MudTextField @bind-Value="_searchString"
                              Placeholder="Pesquisar por paciente ou status"
                              Adornment="Adornment.Start"
                              AdornmentIcon="@Icons.Material.Filled.Search"
                              Class="w-100" />
            </MudItem>
            <MudItem xs="5" md="3" Class="d-flex justify-end align-center">
                <MudButton Color="Color.Primary"
                           StartIcon="@Icons.Material.Filled.Add"
                           OnClick="@OpenDialogAsync"
                           Variant="Variant.Outlined"
                           Class="mt-md-0 mt-2 w-100 w-md-auto">
                    Adicionar
                </MudButton>
            </MudItem>
        </MudGrid>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Código</MudTh>
        <MudTh>Paciente</MudTh>
        <MudTh>Data de Entrada</MudTh>
        <MudTh>Status</MudTh>
        <MudTh></MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Código">@context.SequenceNumber</MudTd>
        <MudTd DataLabel="Paciente">@GetPatientName(context.PatientId)</MudTd>
        <MudTd DataLabel="Data de Entrada">@context.EntryDate?.ToShortDateString()</MudTd>
        <MudTd DataLabel="Status">@context.Status</MudTd>
        <MudTd>
            <MudIconButton Icon="@Icons.Material.Filled.Edit" Color="Color.Primary" OnClick="@(() => OpenEditDialogAsync(context))" />
            <MudIconButton Icon="@Icons.Material.Filled.Delete" Color="Color.Error" OnClick="@(() => DeleteCareAsync(context))" />
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager />
    </PagerContent>
</MudTable>